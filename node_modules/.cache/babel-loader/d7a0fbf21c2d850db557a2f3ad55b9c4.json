{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/magari/git/test_smartmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/home/magari/git/test_smartmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback}from'react';import{AiOutlineClose}from\"react-icons/ai\";import'./SidebarDetail.scss';import ReplaceTextToLink from'./utils/ReplaceTextToLink';var SingleFeatureTable=function SingleFeatureTable(_ref){var feature=_ref.feature;var detailItems=Object.entries(feature.properties).filter(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],_value=_ref3[1];return!key.startsWith('_viewer_');});detailItems.sort(function(_ref4,_ref5){var _ref6=_slicedToArray(_ref4,2),key1=_ref6[0],_value1=_ref6[1];var _ref7=_slicedToArray(_ref5,2),key2=_ref7[0],_value2=_ref7[1];// make sure items with key=`class` and key=`subclass` are always on top\nif(key1==='class')return-1;if(key2==='class')return 1;if(key1==='subclass'&&key2!=='class')return-1;if(key2==='subclass'&&key1!=='class')return 1;return 0;});return/*#__PURE__*/React.createElement(\"table\",{className:\"sidebar-detail-single-feature\"},/*#__PURE__*/React.createElement(\"colgroup\",null,/*#__PURE__*/React.createElement(\"col\",{className:\"label\"}),/*#__PURE__*/React.createElement(\"col\",{className:\"content\"})),/*#__PURE__*/React.createElement(\"tbody\",null,detailItems.map(function(_ref8){var _ref9=_slicedToArray(_ref8,2),key=_ref9[0],value=_ref9[1];return/*#__PURE__*/React.createElement(\"tr\",{className:\"sidebar-detail-item\",key:key},/*#__PURE__*/React.createElement(\"th\",{className:\"label\"},key),/*#__PURE__*/React.createElement(\"td\",{className:\"content\"},/*#__PURE__*/React.createElement(ReplaceTextToLink,{text:value})));})));};var Content=function Content(props){var selected=props.selected,setSelected=props.setSelected;var closeHandler=useCallback(function(event){event.preventDefault();setSelected([]);},[setSelected]);// const catalogItems = Object.fromEntries(selected.map(item => [item.catalog.class, item.catalog]));\nvar groupedFeatures={};var _iterator=_createForOfIteratorHelper(selected),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var feature=_step.value;if(feature.catalog.type!==\"DataItem\")continue;var ary=groupedFeatures[feature.catalog.id]||=[];ary.push(feature);}}catch(err){_iterator.e(err);}finally{_iterator.f();}return/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-detail\"},/*#__PURE__*/React.createElement(\"div\",{className:\"close-btn-container\"},/*#__PURE__*/React.createElement(AiOutlineClose,{className:\"close\",onClick:closeHandler})),Object.entries(groupedFeatures).map(function(_ref10){var _ref11=_slicedToArray(_ref10,2),id=_ref11[0],features=_ref11[1];return/*#__PURE__*/React.createElement(\"div\",{key:id,className:\"sidebar-detail-subsection\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"title\"},features[0].catalog.name),/*#__PURE__*/React.createElement(\"div\",null,features.map(function(feature,idx){return/*#__PURE__*/React.createElement(React.Fragment,{key:idx},/*#__PURE__*/React.createElement(SingleFeatureTable,{feature:feature}),idx<features.length-1&&/*#__PURE__*/React.createElement(\"hr\",null));})));}));};export default Content;","map":{"version":3,"names":["React","useCallback","AiOutlineClose","ReplaceTextToLink","SingleFeatureTable","_ref","feature","detailItems","Object","entries","properties","filter","_ref2","_ref3","_slicedToArray","key","_value","startsWith","sort","_ref4","_ref5","_ref6","key1","_value1","_ref7","key2","_value2","createElement","className","map","_ref8","_ref9","value","text","Content","props","selected","setSelected","closeHandler","event","preventDefault","groupedFeatures","_iterator","_createForOfIteratorHelper","_step","s","n","done","catalog","type","ary","id","push","err","e","f","onClick","_ref10","_ref11","features","name","idx","Fragment","length"],"sources":["/home/magari/git/test_smartmap/src/SidebarDetail.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { AiOutlineClose } from \"react-icons/ai\";\nimport './SidebarDetail.scss'\nimport { CatalogFeature } from './api/catalog';\nimport ReplaceTextToLink from './utils/ReplaceTextToLink';\n\nconst SingleFeatureTable: React.FC<{feature: CatalogFeature}> = ({feature}) => {\n  const detailItems = Object.entries(feature.properties).filter(([key, _value]) => !key.startsWith('_viewer_'));\n\n  detailItems.sort(([key1, _value1], [key2, _value2]) => {\n    // make sure items with key=`class` and key=`subclass` are always on top\n    if (key1 === 'class') return -1;\n    if (key2 === 'class') return 1;\n    if (key1 === 'subclass' && key2 !== 'class') return -1;\n    if (key2 === 'subclass' && key1 !== 'class') return 1;\n\n    return 0;\n  });\n\n  return (\n    <table className='sidebar-detail-single-feature'>\n      <colgroup>\n        <col className='label' />\n        <col className='content' />\n      </colgroup>\n      <tbody>\n        { detailItems.map(([key, value]) => (\n          <tr className=\"sidebar-detail-item\" key={key}>\n            <th className='label'>{key}</th>\n            <td className='content'><ReplaceTextToLink text={value} /></td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n};\n\ntype Props = {\n  selected: CatalogFeature[]\n  setSelected: React.Dispatch<React.SetStateAction<CatalogFeature[]>>\n}\n\nconst Content: React.FC<Props> = (props) => {\n  const { selected, setSelected } = props;\n\n  const closeHandler = useCallback<React.MouseEventHandler>((event) => {\n    event.preventDefault();\n    setSelected([]);\n  }, [setSelected]);\n\n  // const catalogItems = Object.fromEntries(selected.map(item => [item.catalog.class, item.catalog]));\n  const groupedFeatures: { [key: string]: CatalogFeature[] } = {};\n  for (const feature of selected) {\n    if (feature.catalog.type !== \"DataItem\") continue;\n    const ary = groupedFeatures[feature.catalog.id] ||= [];\n    ary.push(feature);\n  }\n\n  return (\n    <div className='sidebar-detail'>\n      <div className='close-btn-container'>\n        <AiOutlineClose className='close' onClick={closeHandler} />\n      </div>\n      { Object.entries(groupedFeatures).map(([id, features]) => (\n        <div key={id} className='sidebar-detail-subsection'>\n          <h2 className='title'>{features[0].catalog.name}</h2>\n          <div>\n            { features.map((feature, idx) => (<React.Fragment key={idx}>\n              <SingleFeatureTable feature={feature} />\n              { idx < features.length - 1 && <hr /> }\n            </React.Fragment>)) }\n          </div>\n        </div>\n      )) }\n    </div>\n  );\n}\n\nexport default Content;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}